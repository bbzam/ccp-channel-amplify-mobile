<div class="table-container">
  <div class="reorder-controls">
    @if (!reorderMode) {
    <button
      class="buttonPrimary"
      mat-raised-button
      (click)="toggleReorderMode()"
    >
      <mat-icon>swap_vert</mat-icon>
      Reorder Tags
    </button>
    }
  </div>

  @if (!reorderMode) {
  <app-table
    [data]="tableData"
    [columns]="columns"
    [displayedColumns]="displayedColumns"
    (refreshClick)="handleRefreshClick()"
    (getContent)="getAllTags($event)"
    (rowClick)="handleRowClick($event)"
  >
  </app-table>
  } @else {
  <div class="reorder-container">
    <div class="reorder-actions">
      <button class="buttonPrimary" mat-raised-button (click)="saveOrder()">
        <mat-icon>save</mat-icon>
        Save Order
      </button>
      <button
        class="buttonTertiary"
        mat-raised-button
        (click)="cancelReorder()"
      >
        <mat-icon>close</mat-icon>
        Cancel
      </button>
    </div>
    <div class="reorder-header">
      <h3>Drag and drop to reorder tags</h3>
      <p>Changes will be saved when you click "Save Order"</p>
    </div>
    <div class="drag-list" cdkDropList (cdkDropListDropped)="onDrop($event)">
      @for (tag of tableData; track tag.id; let i = $index) {
      <div class="drag-item" cdkDrag>
        <div class="drag-handle" cdkDragHandle>
          <mat-icon>drag_indicator</mat-icon>
        </div>
        <div class="tag-content">
          <div class="tag-info">
            <span class="tag-name">{{ tag.tag }}</span>
            <span
              class="tag-status"
              [class.visible]="tag.isVisible"
              [class.hidden]="!tag.isVisible"
            >
              {{ tag.isVisible ? "Visible" : "Hidden" }}
            </span>
          </div>
          <div class="tag-order">{{ i + 1 }}</div>
        </div>
      </div>
      }
    </div>
  </div>
  }
</div>
