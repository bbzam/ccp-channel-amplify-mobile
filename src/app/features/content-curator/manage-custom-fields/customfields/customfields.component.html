<div class="table-container">
  <div class="reorder-controls">
    @if (!reorderMode) {
    <button
      class="buttonPrimary"
      mat-raised-button
      (click)="toggleReorderMode()"
    >
      <mat-icon>swap_vert</mat-icon>
      Reorder Custom Fields
    </button>
    }
  </div>

  @if (!reorderMode) {
  <app-table
    [data]="tableData"
    [columns]="columns"
    [displayedColumns]="displayedColumns"
    (refreshClick)="handleRefreshClick()"
    (getContent)="getAllCustomFields($event)"
    (rowClick)="handleRowClick($event)"
  >
  </app-table>
  } @else {
  <div class="reorder-container">
    <div class="reorder-actions">
      <button class="buttonPrimary" mat-raised-button (click)="saveOrder()">
        <mat-icon>save</mat-icon>
        Save Order
      </button>
      <button
        class="buttonTertiary"
        mat-raised-button
        (click)="cancelReorder()"
      >
        <mat-icon>close</mat-icon>
        Cancel
      </button>
    </div>
    <div class="reorder-header">
      <h3>Drag and drop to reorder custom fields</h3>
      <p>Changes will be saved when you click "Save Order"</p>
    </div>
    <div class="drag-list" cdkDropList (cdkDropListDropped)="onDrop($event)">
      @for (field of tableData; track field.id; let i = $index) {
      <div class="drag-item" cdkDrag>
        <div class="drag-handle" cdkDragHandle>
          <mat-icon>drag_indicator</mat-icon>
        </div>
        <div class="field-content">
          <div class="field-info">
            <span class="field-name">{{ field.fieldName }}</span>
          </div>
          <div class="field-order">{{ i + 1 }}</div>
        </div>
      </div>
      }
    </div>
  </div>
  }
</div>
