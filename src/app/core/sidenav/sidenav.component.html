<mat-drawer-container [hasBackdrop]="true">
  <mat-drawer class="sidenav" #drawer mode="over">
    <!-- Header with close button -->
    <div class="sidenav-header">
      <button
        class="close-button"
        mat-icon-button
        (click)="closeToggleDrawer()"
        aria-label="Close navigation"
      >
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <!-- User Profile Section -->
    <div class="user-profile-section">
      <mat-card class="user-card">
        <mat-card-header>
          <div class="user-info">
            <div class="avatar-container">
              <mat-icon class="user-avatar">account_circle</mat-icon>
            </div>
            <div class="user-details">
              <mat-card-title class="username">{{ username }}</mat-card-title>
              <mat-card-subtitle class="user-email">{{
                email
              }}</mat-card-subtitle>
            </div>
          </div>
        </mat-card-header>
      </mat-card>
    </div>

    <!-- Navigation Menu for Subscribers -->
    @if (role === 'SUBSCRIBER') {
    <div class="nav-section">
      <div class="section-title">Navigation</div>
      <mat-card class="nav-card">
        <mat-card-content>
          @for (item of navItems; track item) {
          <button
            [ngClass]="{ 'active-nav-item': item.routeLink === currentRoute }"
            class="nav-item"
            mat-button
            (click)="navigate(item.routeLink)"
          >
            <mat-icon class="nav-icon">{{
              item.icon || "play_arrow"
            }}</mat-icon>
            <span class="nav-label">{{ item.label }}</span>
          </button>
          }
        </mat-card-content>
      </mat-card>
    </div>

    <mat-divider class="section-divider"></mat-divider>
    }

    <!-- Action Buttons Section -->
    <div class="actions-section">
      <div class="section-title">Actions</div>
      <mat-card class="actions-card">
        <mat-card-content>
          @if (role === 'SUBSCRIBER') {
          <button class="action-item" mat-button (click)="openSearch()">
            <mat-icon class="action-icon">search</mat-icon>
            <span class="action-label">Search</span>
          </button>
          <button class="action-item" mat-button (click)="favoritesOnClick()">
            <mat-icon class="action-icon">favorite</mat-icon>
            <span class="action-label">Favourites</span>
          </button>
          }
          <button class="action-item" mat-button (click)="settingOnClick()">
            <mat-icon class="action-icon">settings</mat-icon>
            <span class="action-label">Settings</span>
          </button>
          <button class="action-item logout-item" mat-button (click)="logout()">
            <mat-icon class="action-icon">logout</mat-icon>
            <span class="action-label">Logout</span>
          </button>
        </mat-card-content>
      </mat-card>
    </div>
  </mat-drawer>
</mat-drawer-container>

<app-search-overlay
  [isOpen]="isSearchOpen"
  (closeSearchEvent)="closeSearch()"
  (searchResultSelected)="onSearchResultSelected($event)"
>
</app-search-overlay>
